* E pccd

\begin{align*}
E_{\text{pCCD}} = \sum_{ia} t_i^a <aa|ii> 
\end{align*}

#+BEGIN_SRC f90 :comments org :tangle pccd_energy.irp.f
subroutine pccd_energy(nO, nV, t2, energy)

  implicit none

  BEGIN_DOC
  ! pCCD energy
  END_DOC

  ! in
  integer, intent(in)           :: nO, nV
  double precision, intent(in)  :: t2(nO, nV)

  ! out
  double precision, intent(out) :: energy

  ! internal
  integer                       :: i,a

  ! Final energy
  energy = 0d0
  do a = 1, nV
    do i = 1, nO
      energy = energy + t2(i,a) * vcc_aaii(a,i)
    enddo
  enddo 
  
  ! Add <0|H|0>
  energy = energy + hf_energy

end
#+END_SRC
