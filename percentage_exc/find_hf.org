* Find HF index

Provided
| N_states                 | integer            | number of states          |
| max_exc_degree           | integer            | maximum excitation degree |
| HF_bitmask               | integer(bitstring) | HF determinants           |
| psi_det(N_int,2,N_det)   | integer(bitstring) | Determinants              |
| psi_coef(N_det,N_states) | double precision   | CI coefficients           |
| N_int                    | integer            | Number of int per det     |
| N_det                    | integer            | Number of det             |

Out
| idx_hf | integer | index of the HF det in psi_det |

Internal
| degree | integer | excitation degree              |
| idx_hf | integer | index of the HF det in psi_det |
| i,s    | integer | dummy indexes                  |

#+BEGIN_SRC f90 :comments org :tangle find_hf.irp.f
subroutine find_hf(psidet,Ndet,Nint,idx_hf)

  implicit none

  ! in
  integer(bit_kind), intent(in) :: psidet(Nint,2,Ndet) 
  integer, intent(in) :: Ndet                          
  integer, intent(in) :: Nint                          

  ! out
  integer :: idx_hf

  ! internal
  integer :: i_int,j
  logical :: is_hf

  idx_hf = 0
  do j = 1, Ndet
    is_hf = .True.
    do i_int = 1, Nint
      if (psidet(i_int,1,j) /= HF_bitmask(i_int,1) .or. &
          psidet(i_int,2,j) /= HF_bitmask(i_int,2)) then
        is_hf = .False.
        exit
      endif
      if (.not. is_hf) then
        exit
      endif
    enddo
    if (.not. is_hf) then
      cycle
    endif
    idx_hf = j
    exit
  enddo

  if (idx_hf == 0) then
    print*,'Hf determinant not found, abort'
    call abort
  endif

end
#+END_SRC
