* mo two e integrals

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [integer, dim_list_act_virt_orb]

  implicit none

  BEGIN_DOC
  ! dim of active + virtual MOs
  END_DOC

  dim_list_act_virt_orb = dim_list_act_orb + dim_list_virt_orb

END_PROVIDER
#+END_SRC

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [double precision, list_act_virt, (dim_list_act_virt_orb)]

  implicit none

  BEGIN_DOC
  ! list of active + virtual MOs
  END_DOC

  integer :: i

  do i = 1, dim_list_act_orb
    list_act_virt(i) = list_act(i)
  enddo

  do i = 1, dim_list_virt_orb
    list_act_virt(i+dim_list_act_orb) = list_virt(i)
  enddo

END_PROVIDER
#+END_SRC

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [double precision, two_e_ints, (dim_list_act_virt_orb, dim_list_act_virt_orb, dim_list_act_virt_orb, dim_list_act_virt_orb)]

  implicit none

  BEGIN_DOC
  ! my <pq|rs> integrals for active + virtual orbitals
  END_DOC

  integer :: p,q,r,s
  integer :: pa, qa, ra, sa

  ! function
  double precision :: get_two_e_integral

  PROVIDE mo_two_e_integrals_in_map
  
  do sa = 1, dim_list_act_virt_orb
    s = list_act_virt(sa)
    do ra = 1, dim_list_act_virt_orb
      r = list_act_virt(ra) 
      do qa = 1, dim_list_act_virt_orb
        q = list_act_virt(qa)
        do pa = 1, dim_list_act_virt_orb
          p = list_act_virt(pa)
           
          two_e_ints(pa,qa,ra,sa) = get_two_e_integral(p,q,r,s,mo_integrals_map)
          
        enddo
      enddo
    enddo
  enddo

END_PROVIDER
#+END_SRC

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [double precision, two_e_ints_ppqq, (dim_list_act_virt_orb, dim_list_act_virt_orb)]

  implicit none

  BEGIN_DOC
  ! my <pp|qq> integrals for active + virtual MOs
  END_DOC

  integer :: p,q
  double precision :: get_two_e_integral

  do q = 1, dim_list_act_virt_orb
    do p = 1, dim_list_act_virt_orb
      two_e_ints_ppqq(p,q) = two_e_ints(p,p,q,q)
      !print*,p,q,get_two_e_integral(p,p,q,q,mo_integrals_map), two_e_ints_ppqq(p,q)
    enddo
  enddo

END_PROVIDER
#+END_SRC

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [double precision, two_e_ints_aaii, (dim_list_virt_orb, dim_list_act_orb)]

  implicit none

  BEGIN_DOC
  ! my <aa|ii> integrals for active + virtual MOs
  ! a: virtual MO
  ! i: active MO
  END_DOC

  integer :: a,tmp_a,i
  double precision :: get_two_e_integral

  do i = 1, dim_list_act_orb
    do a = 1, dim_list_virt_orb
      tmp_a = a + dim_list_act_orb
      two_e_ints_aaii(a,i) = two_e_ints(tmp_a,tmp_a,i,i)
      !print*,a,i,get_two_e_integral(tmp_a,tmp_a,i,i,mo_integrals_map), two_e_ints_aaii(a,i)
    enddo
  enddo

END_PROVIDER
#+END_SRC

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [double precision, two_e_ints_iiaa, (dim_list_act_orb, dim_list_virt_orb)]

  implicit none

  BEGIN_DOC
  ! my <ii|aa> integrals for active + virtual MOs
  ! a: virtual MO
  ! i: active MO
  END_DOC

  integer :: a,tmp_a,i
  double precision :: get_two_e_integral

  do a = 1, dim_list_virt_orb
    tmp_a = a + dim_list_act_orb
    do i = 1, dim_list_act_orb
      two_e_ints_iiaa(i,a) = two_e_ints(i,i,tmp_a,tmp_a)
      !print*,i,a,get_two_e_integral(i,i,tmp_a,tmp_a,mo_integrals_map), two_e_ints_iiaa(i,a)
    enddo
  enddo

END_PROVIDER
#+END_SRC

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [double precision, two_e_ints_iijj, (dim_list_act_orb, dim_list_act_orb)]

  implicit none

  BEGIN_DOC
  ! my <ii|jj> integrals for active MOs
  ! i,j: active MO
  END_DOC

  integer :: i,j
  double precision :: get_two_e_integral

  do j = 1, dim_list_act_orb
    do i = 1, dim_list_act_orb
      two_e_ints_iijj(i,j) = two_e_ints(i,i,j,j)
      !print*,i,j,get_two_e_integral(i,i,j,j,mo_integrals_map), two_e_ints_iijj(i,j)
    enddo
  enddo

END_PROVIDER
#+END_SRC

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [double precision, two_e_ints_aabb, (dim_list_virt_orb, dim_list_virt_orb)]

  implicit none

  BEGIN_DOC
  ! my <aa|bb> integrals for  virtual MOs
  ! a,b: virtual MO
  END_DOC

  integer :: a,b,tmp_a,tmp_b
  double precision :: get_two_e_integral

  do b = 1, dim_list_virt_orb
    tmp_b = b + dim_list_act_orb
    do a = 1, dim_list_virt_orb
      tmp_a = a + dim_list_act_orb
      two_e_ints_aabb(a,b) = two_e_ints(tmp_a,tmp_a,tmp_b,tmp_b)
      !print*,a,b,get_two_e_integral(tmp_a,tmp_a,tmp_b,tmp_b,mo_integrals_map), two_e_ints_aabb(a,b)
    enddo
  enddo
END_PROVIDER
#+END_SRC

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [double precision, two_e_ints_iaia, (dim_list_act_orb, dim_list_virt_orb)]

  implicit none

  BEGIN_DOC
  ! my <ia|ia> integrals for active + virtual MOs
  ! a: virtual MO
  ! i: active MO
  END_DOC

  integer :: a,tmp_a,i
  double precision :: get_two_e_integral

  do a = 1, dim_list_virt_orb
    tmp_a = a + dim_list_act_orb
    do i = 1, dim_list_act_orb
      two_e_ints_iaia(i,a) = two_e_ints(i,tmp_a,i,tmp_a)
      !print*,i,a,get_two_e_integral(i,tmp_a,i,tmp_a,mo_integrals_map), two_e_ints_iaia(i,a)
    enddo
  enddo

END_PROVIDER
#+END_SRC

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [double precision, two_e_ints_aiia, (dim_list_virt_orb, dim_list_act_orb)]

  implicit none

  BEGIN_DOC
  ! my <ai|ia> integrals for active + virtual MOs
  ! a: virtual MO
  ! i: active MO
  END_DOC

  integer :: a,tmp_a,i
  double precision :: get_two_e_integral

  do i = 1, dim_list_act_orb
    do a = 1, dim_list_virt_orb
      tmp_a = a + dim_list_act_orb
      two_e_ints_aiia(a,i) = two_e_ints(tmp_a,i,i,tmp_a)
      !print*,a,i,get_two_e_integral(tmp_a,i,i,tmp_a,mo_integrals_map), two_e_ints_aiia(a,i)
    enddo
  enddo

END_PROVIDER
#+END_SRC

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [double precision, fock_matrix_pp, (dim_list_act_virt_orb)]

  implicit none

  BEGIN_DOC
  ! my fock matrix elements f_p^p in mo for active + virtual MOs
  ! p: active or virtual MO
  END_DOC

  integer :: p

  fock_matrix_pp = 0d0
  do p = 1, dim_list_act_virt_orb
    fock_matrix_pp(p) = fock_matrix_mo(p,p)
  enddo

END_PROVIDER
#+END_SRC

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [double precision, fock_matrix_ii, (dim_list_act_orb)]

  implicit none

  BEGIN_DOC
  ! my fock matrix elements f_i^i in mo for active MOs
  ! i: active MO
  END_DOC

  integer :: i

  fock_matrix_ii = 0d0
  do i = 1, dim_list_act_orb
    fock_matrix_ii(i) = fock_matrix_mo(i,i)
  enddo

END_PROVIDER
#+END_SRC

#+BEGIN_SRC f90 :comments org :tangle mo_two_e_integrals.irp.f
BEGIN_PROVIDER [double precision, fock_matrix_aa, (dim_list_virt_orb)]

  implicit none

  BEGIN_DOC
  ! my fock matrix elements f_a^a in mo for virtual MOs
  ! a: virtual MO
  END_DOC

  integer :: a, tmp_a

  fock_matrix_aa = 0d0
  do a = 1, dim_list_virt_orb
    tmp_a = a + dim_list_act_orb
    fock_matrix_aa(a) = fock_matrix_mo(tmp_a,tmp_a)
  enddo

END_PROVIDER
#+END_SRC
